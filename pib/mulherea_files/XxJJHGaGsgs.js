if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }

__d("getNodeForCharacterOffset",[],(function(a,b,c,d,e,f){"use strict";var g=3;function h(a){while(a&&a.firstChild)a=a.firstChild;return a}function i(a){while(a){if(a.nextSibling)return a.nextSibling;a=a.parentNode}}function a(a,b){a=h(a);var c=0,d;while(a){if(a.nodeType===g){d=c+a.textContent.length;if(c<=b&&d>=b)return{node:a,offset:b-c};c=d}a=h(i(a))}}e.exports=a}),null);
__d("getTextContentAccessor",["fbjs/lib/ExecutionEnvironment"],(function(a,b,c,d,e,f){"use strict";var g=null;function a(){!g&&b("fbjs/lib/ExecutionEnvironment").canUseDOM&&(g="textContent"in document.documentElement?"textContent":"innerText");return g}e.exports=a}),null);
__d("ReactDOMSelection",["getNodeForCharacterOffset","getTextContentAccessor"],(function(a,b,c,d,e,f){"use strict";function g(a,b,c,d){return a===c&&b===d}function a(a){var b=window.getSelection&&window.getSelection();if(!b||b.rangeCount===0)return null;var c=b.anchorNode,d=b.anchorOffset,e=b.focusNode,f=b.focusOffset,h=b.getRangeAt(0);try{h.startContainer.nodeType,h.endContainer.nodeType}catch(a){return null}b=g(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset);b=b?0:h.toString().length;var i=h.cloneRange();i.selectNodeContents(a);i.setEnd(h.startContainer,h.startOffset);a=g(i.startContainer,i.startOffset,i.endContainer,i.endOffset);h=a?0:i.toString().length;a=h+b;i=document.createRange();i.setStart(c,d);i.setEnd(e,f);b=i.collapsed;return{start:b?a:h,end:b?h:a}}function c(a,c){if(!window.getSelection)return;var d=window.getSelection(),e=a[b("getTextContentAccessor")()].length,f=Math.min(c.start,e);c=c.end===void 0?f:Math.min(c.end,e);if(!d.extend&&f>c){e=c;c=f;f=e}e=b("getNodeForCharacterOffset")(a,f);a=b("getNodeForCharacterOffset")(a,c);if(e&&a){var g=document.createRange();g.setStart(e.node,e.offset);d.removeAllRanges();f>c?(d.addRange(g),d.extend(a.node,a.offset)):(g.setEnd(a.node,a.offset),d.addRange(g))}}d={getOffsets:a,setOffsets:c};e.exports=d}),null);
__d("getPlainTextFromCometUFIInputState",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a.__type){case"plain-text":return a.text;case"editor-state-based":return a.editorState.getCurrentContent().getPlainText();case"lexical-editor-state-based":throw c("FBLogger")("UFILexicalComposer").mustfixThrow("Lexical editor encountered within draftjs-only code. This should never happen.");default:return a}}g["default"]=a}),98);
__d("CometUFIProgressiveComposerInput.react",["CometPlaceholder.react","FBLogger","FocusRegion.react","Keys","Promise","ReactDOMSelection","SubscriptionsHandler","clearTimeout","deferredLoadComponent","emptyFunction","getPlainTextFromCometUFIInputState","ifRequireable","isSoftNewlineEvent","react","requireDeferred","setTimeout","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=c("requireDeferred")("CometUFIRichComposerInput.react").__setRef("CometUFIProgressiveComposerInput.react"),j=c("requireDeferred")("getEditorStateFromUFI2ComposerState").__setRef("CometUFIProgressiveComposerInput.react"),k=c("deferredLoadComponent")(i),l={disabledProxyInput:{cursor:"bnpdmtie"},emptyPlaceholder:{overflowX:"ni8dbmo4",overflowY:"stjgntxs",textOverflow:"ltmttdrg",whiteSpace:"mshkm1ct"},proxyInput:{backgroundColor:"g5ia77u1",borderTop:"qu0x051f",borderEnd:"esr5mh6w",borderBottom:"e9989ue4",borderStart:"r7d6kgcz",color:"oo9gr5id",height:"datstx6m",outline:"lzcic4wl",resize:"ieid39z1",wordBreak:"qv66sw1b",zIndex:"tkr6xdv7"},proxyInputPlaceholder:{bottom:"i09qtzwb",color:"m9osqain",end:"n7fi1qx3",overflowX:"ni8dbmo4",overflowY:"stjgntxs",pointerEvents:"hzruof5a",position:"pmk7jnqg",start:"j9ispegn",textOverflow:"ltmttdrg",top:"kr520xx4"},proxyInputPlaceholderForFocusedInput:{color:"pipptul6"},proxyInputWrapper:{height:"datstx6m",position:"l9j0dhe7"}};function m(a){a=a.innerText||"";a.replace(/(\r\n|\r|\n)/g,"")===""&&(a="");return a}function n(){return c("ifRequireable")("EditorState",function(a){var b=i.getModuleIfRequireable();if(b!=null){var c=j.getModuleIfRequireable();if(c!=null)return{CometUFIRichComposerInput:b,EditorState:a,getEditorStateFromUFI2ComposerState:c}}})}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=d=a.call.apply(a,[this].concat(f))||this,d.$1=null,d.$2=!1,d.$3=null,d.$4=new(c("SubscriptionsHandler"))(),d.state={proxyInputHasFocus:!1,proxyIsInCompositionMode:!1},d.$7=function(a){d.setState({proxyIsInCompositionMode:!0})},d.$8=function(a){d.setState({proxyIsInCompositionMode:!1})},d.$9=function(a){d.$10(a.target)},d.$11=function(a){document.activeElement===d.$3&&(d.$1=d.$6(a)),d.$3=a,d.props.onInputRefUpdated&&d.props.onInputRefUpdated(a)},d.$12=function(a){a.keyCode===c("Keys").RETURN&&!c("isSoftNewlineEvent")(a)&&(a.preventDefault(),d.props.onCommit())},d.$13=function(a){d.$2=!0;var b=c("setTimeout")(function(){c("FBLogger")("ufi2").warn("_handleProxyMouseDown had no corresonding mouseup event for 30s.")},3e4);d.$4.addSubscriptions({remove:function(){c("clearTimeout")(b)}});var e=function(){var a=function(){c("clearTimeout")(b),d.$2=!1,d.$4.releaseOne(e),d.$3!=null&&d.$3===document.activeElement&&d.$5()};document.addEventListener("mouseup",a);return{remove:function(){document.removeEventListener("mouseup",a)}}}();d.$4.addSubscriptions(e)},d.$14=function(a){var b=d.props.handlePastedFiles;if(b){var c=a.clipboardData;c=c.items!=null?Array.from(c.items):[];c=c.map(function(a){return a.getAsFile()}).filter(Boolean);c.length&&(b(c)==="handled"&&a.preventDefault())}},d.$16=function(a){d.setState({proxyInputHasFocus:!1})},d.$17=function(a){var b=function(){d.$2===!1&&d.$5()},e=n();e==null?(i.loadImmediately(c("emptyFunction")),j.loadImmediately(function(){return b()})):b();d.setState({proxyInputHasFocus:!0});d.props.onFocus&&d.props.onFocus(a)},b)||babelHelpers.assertThisInitialized(d)}b.createEmptyComposerState=function(){var a=n();a=a==null?void 0:a.EditorState;return a!=null?{__type:"editor-state-based",editorState:a.createEmpty()}:{__type:"plain-text",selectionOffsets:null,text:""}};var e=b.prototype;e.$5=function(){var a=this;if(this.state.proxyIsInCompositionMode===!0||this.props.composerState.inputState.__type!=="plain-text")return;var b=n();if(b==null)return;this.props.onComposerStateChange(function(d){var e,f=d.inputState;if(f.__type!=="plain-text"){c("FBLogger")("ufi2").warn("We were asked to commit the text and selection state of the proxy input, but the current input state is of type `%s` when we expected it to be of type `plain-text`. Investigate why a reference to the proxy input existed when the input state was of this type.",f.__type);return d}e=babelHelpers["extends"]({},d,{inputState:babelHelpers["extends"]({},f,{selectionOffsets:(e=(e=a.$1)!=null?e:a.$6())!=null?e:f.selectionOffsets})});return babelHelpers["extends"]({},d,{inputState:{__type:"editor-state-based",editorState:b.getEditorStateFromUFI2ComposerState(e)}})})};e.$10=function(a){var b=m(a);this.props.onComposerStateChange(function(a){var d=a.inputState;if(d.__type!=="plain-text"){c("FBLogger")("ufi2").warn("We were asked to handle an input event for the proxy input, but the current input state is of type `%s` when we expected it to be of type `plain-text`. Investigate why a reference to the proxy input existed when the input state was of this type.",d.__type);return a}return babelHelpers["extends"]({},a,{inputState:babelHelpers["extends"]({},d,{text:b})})})};e.$6=function(a){a===void 0&&(a=this.$3);return a!=null&&document.activeElement===a?d("ReactDOMSelection").getOffsets(a):null};e.$15=function(a){if(a.composerState.inputState.__type!=="plain-text")return;var b=this.$3;if(b){a=a.composerState.inputState;var e,f;switch(a.__type){case"plain-text":e=a.text;f=a.selectionOffsets;break;case"editor-state-based":default:e=a.editorState.getCurrentContent().getBlockMap().map(function(a){return a?a.getText():""}).join("\n");c("FBLogger")("ufi2").warn("Unimplemented: tried to update the UFI2 proxy input's selection using an `EditorState` but we have not yet implemented a function that maps from an `EditorState` to selection offsets.");break}f==null&&(f=document.activeElement===b?d("ReactDOMSelection").getOffsets(b):null);a=m(b);e!==a&&(b.textContent=e,f!=null&&(e===""?(b.innerText="\xa0",d("ReactDOMSelection").setOffsets(b,{end:1,start:1}),document.execCommand("delete",!1,null)):d("ReactDOMSelection").setOffsets(b,f)))}};e.componentDidMount=function(){var a=this,b=this.props.composerState.inputState;this.$3&&b.__type==="plain-text"&&this.$15(this.props);b=n();(b==null?void 0:b.CometUFIRichComposerInput)==null&&this.$4.addSubscriptions(i.onReady(function(b){a.props.composerState.inputState.__type==="editor-state-based"&&a.forceUpdate()}))};e.componentDidUpdate=function(){this.props.composerState.inputState.__type==="plain-text"&&this.$5(),this.$15(this.props)};e.componentWillUnmount=function(){this.$4.release()};e.execCommand=function(a){this.props.handleCommand&&(a.__type==="PrefillMention"&&(i.loadImmediately(c("emptyFunction")),this.$5()),this.props.handleCommand(a))};e.render=function(){var a=this.props,b=a.xstyle;a=babelHelpers.objectWithoutPropertiesLoose(a,["xstyle"]);var e=c("getPlainTextFromCometUFIInputState")(a.composerState.inputState).trim()!=="",f=a.depth?"UFI2ComposerInput/reply":"UFI2ComposerInput/comment",g=h.jsx("div",{className:c("stylex")(b),onClick:a.onClick,role:"none",children:h.jsxs("div",{className:c("stylex")(l.proxyInputWrapper),children:[h.jsx("div",{className:c("stylex")(a.composerState.isLocked&&l.disabledProxyInput,l.proxyInput),contentEditable:a.composerState.isLocked===!1,"data-testid":void 0,onBlur:this.$16,onCompositionEnd:this.$8,onCompositionStart:this.$7,onFocus:this.$17,onInput:this.$9,onKeyDown:this.$12,onMouseDown:this.$13,onPaste:this.$14,ref:this.$11,role:"textbox",tabIndex:0}),e?null:h.jsx("div",{className:c("stylex")(l.proxyInputPlaceholder,this.state.proxyInputHasFocus&&l.proxyInputPlaceholderForFocusedInput),children:a.placeholder})]})});return h.jsx(d("FocusRegion.react").FocusRegion,{recoverFocusQuery:null,children:h.jsxs(c("CometPlaceholder.react"),{fallback:g,children:[h.jsx(o,{shouldSuspend:this.state.proxyIsInCompositionMode}),h.jsx(k,babelHelpers["extends"]({},a,{composerState:a.composerState,onClick:a.onClick,onCommit:a.onCommit,onComposerStateChange:a.onComposerStateChange,onInputRefUpdated:a.onInputRefUpdated,placeholder:a.placeholder,placeholderClassName:c("stylex")(!e&&l.emptyPlaceholder),webDriverTestID:f+":rich-input",xstyle:b}))]})})};return b}(h.Component);function o(a){a=a.shouldSuspend;if(a)throw new(b("Promise"))(function(){});return null}g["default"]=a}),98);
__d("isCometUFIComposerStateEmpty",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.attachment;a=a.inputState;if(b!=null)return!1;switch(a.__type){case"editor-state-based":return!a.editorState.getCurrentContent().hasText();case"plain-text":return!(a.text&&a.text.trim().length);case"lexical-editor-state-based":throw c("FBLogger")("UFILexicalComposer").mustfixThrow("Lexical editor encountered within draftjs-only code. This should never happen.");default:return a.__type}}g["default"]=a}),98);
__d("setFocusOnCometUFIComposerInputState",["cr:1690"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:1690")}),98);